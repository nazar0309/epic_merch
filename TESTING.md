# OwlBookstore | Testing

Return to [README](README.md)
- - -

## Table of Contents

### [Responsiveness Testing](#responsiveness-testing-1)

### [Browser Compatibility Testing](#browser-compatibility-testing-1)

### [Device Testing](#device-testing-1)

### [Code Validation](#code-validation-1)

* [HTML Validation](#html-validation)
* [CSS Validation](#css-validation)
* [JavaScript Validation](#javascript-validation)
* [Python](#python)

### [Lighthouse Report](#lighthouse-report-1)

### [Bugs](#bugs-1)

* [Resolved Bugs](#resolved-bugs)
* [Unresolved Bugs](#unresolved-bug)

### [Features Testing](#features-testing-1)

- - -

## Responsiveness Testing

The deployed website underwent extensive testing across a spectrum of devices and screen sizes to guarantee its responsiveness and adaptability. Developer Tools were instrumental in simulating diverse screen dimensions, facilitating a comprehensive evaluation of the website's behavior on various devices.
A combination of Bootstrap classes, custom CSS, and template syntax played a pivotal role in crafting the desired design. This strategic implementation not only ensured visual consistency but also maintained functional integrity across different platforms. By leveraging these tools and techniques, the website is poised to deliver an optimized user experience, regardless of the device being used.

![Homepage](/media/readme/homepage.png)

## Browser Compatibility Testing

The project was tested on multiple web browsers to check for compatibility issues and ensure it functions as expected across all of them. This testing process guarantees a smooth and consistent user experience, regardless of the browser used.

<details>
<summary> Firefox
</summary>

![Firefox](/media/readme/firefox.png)
</details>

<details>
<summary> Microsoft Edge
</summary>

![Microsoft Edge](/media/readme/edge.png)
</details>

<details>
<summary> Opera
</summary>

![Opera](/media/readme/opera.png)
</details>

<details>
<summary> Chrome - Laptop
</summary>

![Chrome on Laptop](/media/readme/chrome.png)
</details>

<details>
<summary> Safari - iPad
</summary>

![Safari on iPhone](/media/readme/safari.jpg)
</details>

## Device Testing

Device testing encompassed various devices, including iPhone 12 Pro, iPad, MacBook Air, iPhone SE, Lenovo Yoga, Acer, Samsung A14, and Samsung S22. Collaboration with family members, friends, and fellow college students was crucial in executing these tests. This holistic approach ensured a comprehensive evaluation of the website's performance across various devices and screen sizes, contributing to developing a more robust and user-friendly final product.

## Code Validation

### HTML Validation

<details>
<summary> Home Page
</summary>

![Home Page](/media/readme/home_html.png)
</details>

<details>
<summary> Products Page
</summary>

![Products Page](/media/readme/products_html.png)
</details>

<details>
<summary> Products Detail Page
</summary>

![Product Detail Page](/media/readme/product_details_html.png)
</details>

<details>
<summary> Sign Up Page
</summary>

![Sign Up Page](/media/readme/sign_up_html.png)
</details>

<details>
<summary> Login Page
</summary>

![Login Page](/media/readme/sign_in_html.png)
</details>

<details>
<summary> Logout Page
</summary>

![Logout Page](/media/readme/logout_html.png)
</details>

<details>
<summary> Update Product Page
</summary>

![Update Product Page](/media/readme/edit_product_html.png)
</details>

<details>
<summary> Add Product Page
</summary>

![Add Product Page](/media/readme/add_product_html.png)
</details>

<details>
<summary> Bag Page
</summary>

![Bag Page](/media/readme/bag_html.png)
</details>

<details>
<summary> Checkout Page
</summary>

![Checkout Page](/media/readme/checkout_html.png)
</details>

<details>
<summary> Checkout Success
</summary>

![Checkout and Order History Page](/media/readme/checkout_success_html.png)
</details>

<details>
<summary> My Profile Page
</summary>

![My Profile Page](/media/readme/profile_html.png)
</details>

<details>
<summary> Contact Us Page
</summary>

![Contact Us Page](/media/readme/contact_us_html.png)
</details>

### CSS Validation

<details>
<summary> Custom CSS - base.css
</summary>

![Base css](/media/readme/base_css.png)
</details>

<details>
<summary> Custom CSS - profile.css
</summary>

![Profile css](/media/readme/profile_css.png)
</details>

<details>
<summary> Custom CSS - checkout.css
</summary>

![Checkout css](/media/readme/checkout_css.png)
</details>

<details>
<summary> Custom CSS - add_product
</summary>

![Add_product css](/media/readme/add_product_css.png)
</details>

### JavaScript Validation

<details>
<summary> Custom JS stripe_elements.js
</summary>

![Stripe_elements js](/media/readme/stripe_elements_js.png)
</details>

<details>
<summary> Custom JS countryfield.js
</summary>

![Countryfield js](/media/readme/countryfield_js.png)
</details>

<details>
<summary> Custom JS on bag template
</summary>

![Bag js](/media/readme/bag_js.png)
</details>

<details>
<summary> Custom JS on homepage
</summary>

![Homepage js](/media/readme/home_js.png)
</details>

<details>
<summary> Custom JS on product_details page
</summary>

![Product_details js](/media/readme/product_details_js.png)
</details>

<details>
<summary> Custom JS on products page
</summary>

![Products js](/media/readme/products_js.png)
</details>



### Python

#### bag app

<details>
<summary> context.py </summary>

![context.py](/media/readme/py_1.png)
</details>

<details>
<summary> bag_tools.py </summary>

![bag_tools.py](/media/readme/py_2.png)
</details>

<details>
<summary> urls.py </summary>

![urls.py](/media/readme/py_3.png)
</details>

<details>
<summary> views.py </summary>

![views.py](/media/readme/py_4.png)
</details>

#### checkout app

<details>
<summary> admin.py </summary>

![admin.py](/media/readme/py_5.png)
</details>

<details>
<summary> forms.py </summary>

![forms.py](/media/readme/py_6.png)
</details>

<details>
<summary> models.py </summary>

![models.py](/media/readme/py_7.png)
</details>

<details>
<summary> signals.py </summary>

![signals.py](/media/readme/py_8.png)
</details>

<details>
<summary> urls.py </summary>

![urls.py](/media/readme/py_9.png)
</details>

<details>
<summary> views.py </summary>

![views.py](/media/readme/py_10.png)
</details>

<details>
<summary> webhooks.py </summary>

![webhooks.py](/media/readme/py_11.png)
</details>

<details>
<summary> webhook_handler.py </summary>

![webhook_handler.py](/media/readme/py_12.png)
</details>

#### home app

<details>
<summary> urls.py </summary>

![urls.py](/media/readme/py_25.png)
</details>

<details>
<summary> views.py </summary>

![views.py](/media/readme/py_13.png)
</details>

#### products app

<details>
<summary> admin.py </summary>

![admin.py](/media/readme/py_14.png)
</details>

<details>
<summary> forms.py </summary>

![forms.py](/media/readme/py_15.png)
</details>

<details>
<summary> models.py </summary>

![models.py](/media/readme/py_16.png)
</details>

<details>
<summary> urls.py </summary>

![urls.py](/media/readme/py_17.png)
</details>

<details>
<summary> views.py </summary>

![views.py](/media/readme/py_18.png)
</details>

#### profiles app

<details>
<summary> forms.py </summary>

![forms.py](/media/readme/py_19.png)
</details>

<details>
<summary> models.py </summary>

![models.py](/media/readme/py_20.png)
</details>

<details>
<summary> urls.py </summary>

![urls.py](/media/readme/py_21.png)
</details>

<details>
<summary> views.py </summary>

![views.py](/media/readme/py_22.png)
</details>

### epic_merch project

<details>
<summary> urls.py </summary>

![urls.py](/media/readme/py_23.png)
</details>

<details>
<summary> settings.py - line too long, django-allauth password validation code </summary>

![settings.py](/media/readme/py_24.png)
</details>


## Lighthouse Report

Most common issue affecting performance was AWS loading time, HTTP1 protocol and Stipe.js.

<details>
<summary> Home Page
</summary>

![Home Page](/media/readme/lt_home.png)
</details>

<details>
<summary> Contact Us Page
</summary>

![Contact Us Page](/media/readme/lt_contact_us.png)
</details>

<details>
<summary> Products Page
</summary>

![Products Page](/media/readme/lt_products.png)
</details>

<details>
<summary> Product Details Page
</summary>

![Product Details Page](/media/readme/lt_product_details.png)
</details>

<details>
<summary> Bag Page
</summary>

![Bag Page](/media/readme/lt_bag.png)
</details>

<details>
<summary> Checkout Page
</summary>
LightHouse can cot access it because it`s private page
</details>

<details>
<summary> Checkout Success/Order History Page
</summary>

LightHouse can cot access it because it`s private page
</details>

<details>
<summary> Profile Page
</summary>

LightHouse can cot access it because it`s private page
</details>

<details>
<summary> Sign Up Page
</summary>

![Sign Up Page](/media/readme/lt_sign_up.png)
</details>

<details>
<summary> Login Page
</summary>

![Login Page](/media/readme/lt_sign_in.png)
</details>

<details>
<summary> Logout Page
</summary>

LightHouse can cot access it because it`s private page
</details>

<details>
<summary> 404 page
</summary>

![Login Page](/media/readme/lt_404.png)
</details>

## Bugs

### Resolved Bugs

#### Confirmation Email Not Sent to Users After Checkout

* After a successful purchase, some authenticated users did not receive a confirmation email, whereas guest users received it correctly. The issue was caused by incorrect handling of the email field in the checkout function. The issue was fixed by ensuring that the email is properly fetched and used in the send_mail function.

<details>
<summary> Code changes
</summary>

    ```python
    # checkout/views.py
    user_email = order.email
    send_mail(
        subject, message, settings.DEFAULT_FROM_EMAIL, [user_email],
        fail_silently=False,
    )

```

</details>

#### Superusers Unable to Add Products

* Superusers attempting to add products encountered validation errors despite filling out the form correctly. The issue was due to missing error handling in the add_product function when processing form files. The issue was resolved by improving error messages and ensuring that file handling was properly included in form validation.

<details>
<summary> Code changes
</summary>

    ```python

    # products/views.py
    form = ProductForm(request.POST, request.FILES)  # Ensure file uploads are processed
    if form.is_valid():
        product = form.save()
        messages.success(request, 'Successfully added product!')

```

</details>

#### Duplicate Newsletter Subscriptions

* Users were able to subscribe multiple times to the newsletter despite the email field being unique. The issue was caused by duplicate models handling newsletter subscriptions (NewsletterSubscriber and Subscriber). The issue was resolved by consolidating the models and enforcing validation at the form level.

<details>
<summary> Code changes
</summary>

```python

        # models.py
    class Subscriber(models.Model):
        email = models.EmailField(unique=True)  # Enforce uniqueness
        subscribed_at = models.DateTimeField(auto_now_add=True)

```

</details>

#### JavaScript Payment Form Validation Errors

* When filling out the payment form, users encountered JavaScript errors related to the card.addEventListener function. The issue was caused by an incorrect reference to the card-errors element. The issue was fixed by ensuring the correct selection of the error message container.

<details>
<summary> Code changes
</summary>

```javascript

// checkout/static/js/stripe_elements.js
var errorDiv = document.getElementById('card-errors');
if (event.error) {
    var html = `
        <span class="icon" role="alert">
            <i class="fas fa-times"></i>
        </span>
        <span>${event.error.message}</span>
    `;
    $(errorDiv).html(html); // Ensure correct reference
}

```

</details>

#### Deployment Issues

* The project failed to deploy due to missing environment variables for Stripe payment integration. The issue was fixed by ensuring that all required environment variables were set in the hosting platform.

<details>
<summary> Stripe keys error
</summary>

# .env
STRIPE_PUBLIC_KEY=your_public_key_here
STRIPE_SECRET_KEY=your_secret_key_here
</details>

#### **HTML Validation Errors**
When testing HTML code, some validation errors were displayed:

- `<div>` elements containing incorrect `aria-*` attributes (resolved by replacing with valid attributes).
- `<div>` elements containing `href` attributes (resolved by replacing with `data-bs-target`).
- `<div>` elements containing `tabindex` attributes (resolved by removing the attribute).
- `<input>` elements containing `unchecked` attributes (resolved by removing the attribute).
- Incorrect heading order (fixed by following a descending heading order).
- Warnings for `<script>` tags with unnecessary `type="text/javascript"` attributes (fixed by removing the attribute).
- `<ul>` elements containing `aria-labelledby` attributes not linked to describing elements (replaced with `title` attributes).
- `<div>` elements containing `aria-label` attributes (fixed by replacing with `title` attributes).
- `<a>` elements nested in `<li>` elements containing `aria-label` attributes (fixed by replacing with `title` attributes).
- `<input>` elements described by `aria-describedby` attributes (fixed by replacing with `title` attributes).

```html 

#### Python Validation Erros

* Line too long, reduce the lenght of the characters per line
* White spaces trailing, removed empty spaces
* One empty line when two needed, added additional line
* context.py error

    <details>
    <summary> Context Error
    </summary>
        Error: Attempted to use `wishlist_items` without checking if the user is authenticated.
    </details>

    <details>
    <summary> Solution
    </summary>

    bag/context.py

    ```python

        # wishlist, created = Wishlist.objects.get_or_create(user=request.user)
        # wishlist_items = request.user.wishlist.items.all()
        if request.user.is_authenticated:
            wishlist, created = Wishlist.objects.get_or_create(user=request.user)
            wishlist_items = request.user.wishlist.items.all()
        else:
            wishlist_items = 0

    ```

    </details>

* checkout/views.py error

    <details>
    <summary> Context Error
    </summary>
         In the `checkout/views.py`, the following code had a missing implementation to properly process the order. The updated solution is as follows.
    </details>
    <details>
    <summary> Solution
    </summary>

    ```python

    if order_form.is_valid():
        order = order_form.save(commit=False)
        pid = request.POST.get('client_secret').split('_secret')[0]
        # order.stipe_pid = pid
        order.stripe_pid = pid
        order.original_bag = json.dumps(bag)
        order.save()
        for item_id, quantity in bag.items():
    ```

    </details>

#### Javascript Validation Erros

* missing `;`, fixed by adding missing elements
* blankspaces, fixed by deleting them

### Unresolved Bug

#### None

## Features Testing

| Page          | User Action   | Expected Result  | Notes            |
|---------------|---------------|------------------|------------------|
| Home Page  | Nav Bar  |  |  |
|               | Hover over Navigation bar and Footer elements | Change colour/add border | PASS |
|               | Click on Logo/Home button | Redirect to Home Page | PASS        |
|               | Click on Register - Navigation Bar | Redirect to Sign Up page | PASS |
|               | Click on View Products button - Hero Section | Redirect to Products page | PASS |
|               | Click on All Products - By Price | Redirects to Products and sort by price in ascending order | PASS |
|               | Click on All Products - By Rating | Redirects to Products and sort by rating in descending order | PASS |
|               | Click on All Products - By Category | Redirects to Products and sort by category in ascending order | PASS |
|               | Click on All Products - All Products | Redirects to Products | PASS |
|               | Click on Headphones | Opens submenu with headphones categories | PASS |
|               | Click on Keyboards | Opens submenu with keyboards categories | PASS |
|               | Click on Gaming mouses | Opens submenu with gaming mouses categories | PASS |
|               | Click on Razer | Opens submenu with razer products | PASS |
|               | Click on HyperX | Opens submenu with hyperx products | PASS |
|               | Click on Steel Series | Opens submenu with steel series products | PASS |
|               | Click on Cart | Redirects to cart | PASS |
|               | Click on My Account | Opens submenu | PASS |
|               | Click on My Account - Login | Redirects to login page | PASS |
|               | Click on My Account - Register | Redirects to signup page | PASS |
|               | When logged |  |  |
|               | Click on Logout | Redirects to logout page | PASS |
|               | Click on My Account - My Profile | Redirect to My Profile Page | PASS |
|               | When logged - admin |  |  |
|               | Hover Over My Account - Product Management | Redirects to add product page | PASS |
|               | Banner | Free delivery| PASS |
| Home Page | Footer |  |  |


- - -

Return to [README](README.md)